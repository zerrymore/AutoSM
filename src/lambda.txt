Gen(Alice, Na)
Op(Alice, assign(message1, aenc(concat(idA, Na), pkB)))
Send(Alice, Bob, message1)
Knows(role(Bob), pkA, pkB)
Recv(Bob, Alice, message1)
Op(Bob, adec(message1, skB))
Gen(Bob, Nb)
Op(Bob, assign(message2, aenc(concat(Na, Nb), pkA)))
Send(Bob, Alice, message2)
Recv(Alice, Bob, message2)
Op(Alice, adec(message2, pkA))
Op(Alice, assign(cypher2, aenc(Nb, pkB)))
Send(Alice, Bob, cypher2)
Recv(Bob, Alice, cypher2)
Op(Bob, adec(cypher2, skB))